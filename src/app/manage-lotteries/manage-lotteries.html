<h1>Owned Lotteries</h1>
<div class="actions-container">
  <p-button
    label="Create Lottery"
    icon="pi pi-plus"
    (click)="openCreateLottery()"
  ></p-button>
</div>
<p-dialog
  [visible]="createLotteryDialogVisible()"
  (visibleChange)="createLotteryDialogVisible.set($event)"
  header="Create Lottery"
  [modal]="true"
  [dismissableMask]="false"
  [draggable]="false"
  [resizable]="false"
  position="top"
>
  <div>
    <p-float-label variant="in">
      <label>Name</label>
      <input
        pInputText
        [formControl]="nameControl"
      />
    </p-float-label>
    <p-message
      severity="secondary"
      size="small"
      variant="simple"
    >Only letters, numbers and '-'
    </p-message>
  </div>
  <ng-template #footer>
    <p-button
      label="Create"
      [loading]="createNewLotteryLoading()"
      (click)="createNewLottery()"
    />
  </ng-template>
</p-dialog>

@if (lotteries.isLoading()) {
  <p-progress-spinner class="full" ariaLabel="loading"/>
} @else if (lotteries.hasValue()) {
  <div class="lotteries-container">
    @for (lottery of lotteries.value(); track lottery.name) {
      <p-card class="lottery-card">
        <ng-template #title>
          <span>{{ lottery.name }}</span
          ><span># {{ lottery | countExtractions }}</span>
        </ng-template>
        <div><span class="pi pi-arrow-right"></span> {{ lottery | nextExtractionTime }}</div>
        <div><span class="pi pi-arrow-left"></span> {{ lottery | lastExtractionTime }}</div>
        <ng-template #footer>
          <span class="users"><span class="pi pi-users"></span> {{ lottery.participants }}</span>
          <p-button
            icon="pi pi-cog"
            [size]="'small'"
            routerLink="/lotteries/manage/{{ lottery.name }}"
          />
        </ng-template>
      </p-card>
    }
  </div>
}
